{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/adrianthompson/Documents/with-redux-app/HOCs/with-auth.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { withFirebase } from '.';\nimport * as cache from '../lib/cache';\nimport Router from 'next/router';\n\nconst withAuthentication = Component => {\n  class withAuthentication extends React.Component {\n    constructor(props) {\n      super(props);\n\n      _defineProperty(this, \"ifNotAuthRouteToSignIn\", () => {\n        this.setState({\n          authUser: null\n        });\n        Router.push('/signin');\n      });\n\n      _defineProperty(this, \"ifAuthSaveToCache\", authUser => {\n        this.setState({\n          authUser\n        });\n        return cache.saveToCache('uid', authUser.uid);\n      });\n\n      _defineProperty(this, \"signOut\", () => {\n        cache.clearFromCache('uid', '');\n        Router.push('/signin');\n      });\n\n      _defineProperty(this, \"signIn\", (email, password) => {// this is done at page level. wrapping '/signin' with `withAuthentication`\n        // would make it only visible to users who are signed in === Endless loop.\n      });\n\n      this.state = {\n        authUser: null\n      };\n    }\n\n    componentDidMount() {\n      this.listener = this.props.firebase.auth.onAuthStateChanged(authUser => {\n        authUser ? this.ifAuthSaveToCache(authUser) : this.ifNotAuthRouteToSignIn();\n      }); // this.ifNotAuthRouteToSignIn();\n    }\n\n    componentWillUnmount() {\n      this.listener();\n    }\n\n    render() {\n      const {\n        authUser\n      } = this.state;\n      return __jsx(Component, _extends({}, this.props, {\n        authUser: authUser,\n        signOut: this.signOut,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53\n        },\n        __self: this\n      }));\n    }\n\n  }\n\n  return withFirebase(withAuthentication);\n};\n\nexport default withAuthentication;","map":{"version":3,"sources":["/home/adrianthompson/Documents/with-redux-app/HOCs/with-auth.js"],"names":["React","withFirebase","cache","Router","withAuthentication","Component","constructor","props","setState","authUser","push","saveToCache","uid","clearFromCache","email","password","state","componentDidMount","listener","firebase","auth","onAuthStateChanged","ifAuthSaveToCache","ifNotAuthRouteToSignIn","componentWillUnmount","render","signOut"],"mappings":";;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,QAA6B,GAA7B;AACA,OAAO,KAAKC,KAAZ,MAAuB,cAAvB;AACA,OAAOC,MAAP,MAAmB,aAAnB;;AAEA,MAAMC,kBAAkB,GAAGC,SAAS,IAAI;AACtC,QAAMD,kBAAN,SAAiCJ,KAAK,CAACK,SAAvC,CAAiD;AAC/CC,IAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,YAAMA,KAAN;;AADiB,sDAgBM,MAAM;AAC7B,aAAKC,QAAL,CAAc;AACZC,UAAAA,QAAQ,EAAE;AADE,SAAd;AAGAN,QAAAA,MAAM,CAACO,IAAP,CAAY,SAAZ;AACD,OArBkB;;AAAA,iDAuBCD,QAAQ,IAAI;AAC9B,aAAKD,QAAL,CAAc;AAAEC,UAAAA;AAAF,SAAd;AACA,eAAOP,KAAK,CAACS,WAAN,CAAkB,KAAlB,EAAyBF,QAAQ,CAACG,GAAlC,CAAP;AACD,OA1BkB;;AAAA,uCAgCT,MAAM;AACdV,QAAAA,KAAK,CAACW,cAAN,CAAqB,KAArB,EAA4B,EAA5B;AACAV,QAAAA,MAAM,CAACO,IAAP,CAAY,SAAZ;AACD,OAnCkB;;AAAA,sCAqCV,CAACI,KAAD,EAAQC,QAAR,KAAqB,CAC5B;AACA;AACD,OAxCkB;;AAEjB,WAAKC,KAAL,GAAa;AACXP,QAAAA,QAAQ,EAAE;AADC,OAAb;AAGD;;AAEDQ,IAAAA,iBAAiB,GAAG;AAClB,WAAKC,QAAL,GAAgB,KAAKX,KAAL,CAAWY,QAAX,CAAoBC,IAApB,CAAyBC,kBAAzB,CAA4CZ,QAAQ,IAAI;AACtEA,QAAAA,QAAQ,GACJ,KAAKa,iBAAL,CAAuBb,QAAvB,CADI,GAEJ,KAAKc,sBAAL,EAFJ;AAGD,OAJe,CAAhB,CADkB,CAMlB;AACD;;AAcDC,IAAAA,oBAAoB,GAAG;AACrB,WAAKN,QAAL;AACD;;AAYDO,IAAAA,MAAM,GAAG;AACP,YAAM;AAAEhB,QAAAA;AAAF,UAAe,KAAKO,KAA1B;AACA,aACE,MAAC,SAAD,eAAe,KAAKT,KAApB;AAA2B,QAAA,QAAQ,EAAEE,QAArC;AAA+C,QAAA,OAAO,EAAE,KAAKiB,OAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADF;AAGD;;AAhD8C;;AAmDjD,SAAOzB,YAAY,CAACG,kBAAD,CAAnB;AACD,CArDD;;AAuDA,eAAeA,kBAAf","sourcesContent":["import React from 'react';\nimport { withFirebase } from '.';\nimport * as cache from '../lib/cache';\nimport Router from 'next/router';\n\nconst withAuthentication = Component => {\n  class withAuthentication extends React.Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        authUser: null\n      };\n    }\n\n    componentDidMount() {\n      this.listener = this.props.firebase.auth.onAuthStateChanged(authUser => {\n        authUser\n          ? this.ifAuthSaveToCache(authUser)\n          : this.ifNotAuthRouteToSignIn();\n      });\n      // this.ifNotAuthRouteToSignIn();\n    }\n\n    ifNotAuthRouteToSignIn = () => {\n      this.setState({\n        authUser: null\n      });\n      Router.push('/signin');\n    };\n\n    ifAuthSaveToCache = authUser => {\n      this.setState({ authUser });\n      return cache.saveToCache('uid', authUser.uid);\n    };\n\n    componentWillUnmount() {\n      this.listener();\n    }\n\n    signOut = () => {\n      cache.clearFromCache('uid', '');\n      Router.push('/signin');\n    };\n\n    signIn = (email, password) => {\n      // this is done at page level. wrapping '/signin' with `withAuthentication`\n      // would make it only visible to users who are signed in === Endless loop.\n    };\n\n    render() {\n      const { authUser } = this.state;\n      return (\n        <Component {...this.props} authUser={authUser} signOut={this.signOut} />\n      );\n    }\n  }\n\n  return withFirebase(withAuthentication);\n};\n\nexport default withAuthentication;\n"]},"metadata":{},"sourceType":"module"}