{"version":3,"file":"static/webpack/static/development/pages/home.js.f607fc51cdb99b627c05.hot-update.js","sources":["webpack:///./HOCs/with-auth.js"],"sourcesContent":["import React from 'react';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withFirebase } from '.';\nimport * as cache from '../lib/cache';\nimport Router from 'next/router';\n\nconst withAuthentication = Component => {\n  class withAuthentication extends React.Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        authUser: null\n      };\n    }\n\n    componentDidMount() {\n      this.listener = this.props.firebase.auth.onAuthStateChanged(authUser => {\n        authUser\n          ? this.ifAuthSaveToCache(authUser)\n          : this.ifNotAuthRouteToSignIn();\n      });\n      // this.ifNotAuthRouteToSignIn();\n    }\n\n    ifNotAuthRouteToSignIn = () => {\n      this.setState({\n        authUser: null\n      });\n      Router.push('/signin');\n    };\n\n    ifAuthSaveToCache = authUser => {\n      this.setState({ authUser });\n      return cache.saveToCache('uid', authUser.uid);\n    };\n\n    componentWillUnmount() {\n      this.listener();\n    }\n\n    signOut = () => {\n      cache.clearFromCache('uid', '');\n      Router.push('/signin');\n    };\n\n    signIn = (email, password) => {\n      // this is done at page level. wrapping '/signin' with `withAuthentication`\n      // would make it only visible to users who are signed in === Endless loop.\n    };\n\n    render() {\n      const { authUser } = this.state;\n      return (\n        <Component {...this.props} authUser={authUser} signOut={this.signOut} />\n      );\n    }\n  }\n\n  const mapDispatchToProps = dispatch => ({\n      updateStateUID: () => dispatch()\n  })\n  \n  return compose(\n      withFirebase,\n      connect(null, mapDispatchToProps),\n  )(withAuthentication)\n};\n\nexport default withAuthentication;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAiBA;AACA;AADA;AACA;AAEA;AACA;AACA;AAtBA;AAwBA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AA3BA;AAiCA;AACA;AACA;AACA;AApCA;AAuCA;AACA;AACA;AAvCA;AACA;AADA;AAFA;AAKA;AACA;AARA;AAAA;AAAA;AASA;AACA;AAAA;AACA;AAGA;AAEA;AAhBA;AAAA;AAAA;AA+BA;AACA;AAhCA;AAAA;AAAA;AA4CA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAjDA;AACA;AADA;AAAA;AACA;AAmDA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AACA;AAGA;AAIA;AACA;AACA;;;;A","sourceRoot":""}